module Task9 where

import Data.List (concat, nub)

touches (x, y) (x', y') = abs (x - x') <= 1 && abs (y - y') <= 1
distance (x, y) (x', y') = abs (x - x') + abs (y - y')

get "U" = (0, 1)
get "R" = (1, 0)
get "D" = (0, -1)
get "L" = (-1, 0)

parse line =
    let [direction, count] = words line
    in  take (read count) $ repeat $ get direction

plan =
    let lns = lines input
    in  concat $ map parse lns

go (x, y) (dx, dy) = (x + dx, y + dy)

sign x
    | x == 0 = 0
    | x < 0 = -1
    | x > 0 =  1

diagonals = [(1, 1), (1, -1), (-1, 1), (-1, -1)]

chase tail@(tailX, tailY) head@(headX, headY) =
    case (tailX == headX, tailY == headY) of
        (True, _) -> let delta = headY - tailY
                         s = sign delta
                     in  (tailX, headY - (delta - s))
        (_, True) -> let delta = headX - tailX
                         s = sign delta
                     in  (headX - (delta - s), tailY)
        _ -> snd $ minimum $ map (\x -> (distance head (go tail x), go tail x)) diagonals

pull2 tail newHead = case touches newHead tail of True  -> tail
                                                  False -> tail `chase` newHead

apply (head, tail) delta =
    let newHead = go head delta
    in  (newHead, tail `pull2` newHead)

walk      (head, tail)  []      = [tail]
walk rope@(head, tail)  (x:xs)  = tail : walk (apply rope x) xs

answer1 = length $ nub $ walk ((0, 0), (0, 0)) plan

--

pull [] = []
pull [a] = []
pull (head:middle:xs) =
    let newMiddle = pull2 middle head
    in  newMiddle : pull (newMiddle:xs)

walk2 rope     []     = [last rope]
walk2 (r:rope) (x:xs) =
    let newHead = (go r x)
        newRope = newHead : pull (newHead:rope)
    in  last newRope : walk2 newRope xs

answer2 = length $ nub $ walk2 (take 10 $ repeat (0, 0)) plan

input = "D 1\n\
\U 2\n\
\R 2\n\
\U 1\n\
\R 1\n\
\U 2\n\
\L 2\n\
\D 1\n\
\L 2\n\
\R 1\n\
\L 1\n\
\R 1\n\
\U 2\n\
\D 2\n\
\L 2\n\
\R 2\n\
\L 2\n\
\R 1\n\
\L 1\n\
\D 1\n\
\U 1\n\
\R 1\n\
\U 2\n\
\D 1\n\
\U 1\n\
\D 1\n\
\R 2\n\
\D 1\n\
\U 1\n\
\R 1\n\
\L 2\n\
\R 2\n\
\U 2\n\
\R 2\n\
\L 2\n\
\R 2\n\
\U 2\n\
\D 2\n\
\R 1\n\
\U 2\n\
\D 2\n\
\U 2\n\
\D 1\n\
\L 1\n\
\D 1\n\
\L 1\n\
\R 2\n\
\D 2\n\
\R 2\n\
\D 1\n\
\R 2\n\
\L 1\n\
\R 1\n\
\L 2\n\
\D 2\n\
\U 1\n\
\D 1\n\
\R 2\n\
\L 2\n\
\D 2\n\
\L 2\n\
\D 2\n\
\L 1\n\
\R 2\n\
\L 1\n\
\D 1\n\
\L 2\n\
\D 1\n\
\U 1\n\
\R 1\n\
\U 1\n\
\R 2\n\
\D 2\n\
\R 1\n\
\U 2\n\
\D 1\n\
\L 2\n\
\D 2\n\
\L 1\n\
\D 1\n\
\L 1\n\
\D 1\n\
\R 1\n\
\L 1\n\
\U 1\n\
\D 2\n\
\U 1\n\
\D 2\n\
\R 1\n\
\D 2\n\
\L 2\n\
\U 1\n\
\L 1\n\
\R 1\n\
\D 1\n\
\U 1\n\
\D 1\n\
\R 1\n\
\U 2\n\
\L 1\n\
\D 1\n\
\U 2\n\
\R 2\n\
\D 2\n\
\R 1\n\
\D 1\n\
\R 1\n\
\L 1\n\
\R 2\n\
\U 1\n\
\D 1\n\
\L 1\n\
\U 3\n\
\L 2\n\
\U 2\n\
\L 2\n\
\D 2\n\
\L 1\n\
\R 3\n\
\D 1\n\
\U 1\n\
\L 3\n\
\D 3\n\
\U 1\n\
\L 2\n\
\U 1\n\
\R 2\n\
\U 3\n\
\D 2\n\
\L 3\n\
\U 2\n\
\R 2\n\
\D 2\n\
\U 1\n\
\R 1\n\
\L 3\n\
\D 2\n\
\L 3\n\
\D 1\n\
\U 3\n\
\R 3\n\
\U 3\n\
\D 3\n\
\U 3\n\
\L 3\n\
\U 1\n\
\D 1\n\
\U 1\n\
\D 3\n\
\R 3\n\
\D 3\n\
\U 3\n\
\R 3\n\
\L 3\n\
\R 2\n\
\U 3\n\
\D 3\n\
\L 1\n\
\R 2\n\
\D 2\n\
\U 1\n\
\R 1\n\
\L 2\n\
\D 3\n\
\R 3\n\
\D 1\n\
\U 1\n\
\D 1\n\
\U 2\n\
\D 1\n\
\R 1\n\
\D 2\n\
\R 2\n\
\L 1\n\
\D 2\n\
\L 1\n\
\R 2\n\
\L 3\n\
\R 3\n\
\L 1\n\
\U 3\n\
\R 3\n\
\U 3\n\
\D 1\n\
\L 3\n\
\R 1\n\
\L 1\n\
\R 2\n\
\L 1\n\
\U 2\n\
\R 1\n\
\D 2\n\
\R 3\n\
\L 3\n\
\R 2\n\
\U 3\n\
\R 3\n\
\L 1\n\
\R 1\n\
\L 1\n\
\U 1\n\
\L 2\n\
\R 2\n\
\L 3\n\
\D 2\n\
\L 2\n\
\R 3\n\
\D 3\n\
\U 1\n\
\L 2\n\
\D 3\n\
\U 3\n\
\D 3\n\
\R 1\n\
\U 1\n\
\L 2\n\
\U 1\n\
\L 1\n\
\R 1\n\
\U 3\n\
\L 2\n\
\R 1\n\
\D 4\n\
\R 3\n\
\D 3\n\
\L 3\n\
\D 4\n\
\R 4\n\
\L 3\n\
\R 2\n\
\D 2\n\
\R 4\n\
\U 2\n\
\D 3\n\
\L 1\n\
\R 2\n\
\U 4\n\
\R 3\n\
\D 2\n\
\U 1\n\
\D 4\n\
\R 1\n\
\D 3\n\
\U 3\n\
\L 2\n\
\R 2\n\
\L 3\n\
\R 3\n\
\L 4\n\
\D 3\n\
\L 2\n\
\U 3\n\
\L 1\n\
\R 2\n\
\D 4\n\
\R 3\n\
\U 3\n\
\L 2\n\
\U 3\n\
\D 2\n\
\L 4\n\
\D 4\n\
\L 4\n\
\U 4\n\
\R 1\n\
\D 1\n\
\R 3\n\
\U 3\n\
\R 3\n\
\D 3\n\
\L 1\n\
\U 1\n\
\R 3\n\
\L 2\n\
\R 2\n\
\D 2\n\
\R 4\n\
\U 4\n\
\L 4\n\
\D 3\n\
\L 2\n\
\R 4\n\
\L 2\n\
\D 1\n\
\L 2\n\
\R 4\n\
\U 2\n\
\L 2\n\
\U 3\n\
\L 4\n\
\R 2\n\
\L 4\n\
\D 2\n\
\L 1\n\
\D 4\n\
\L 3\n\
\U 2\n\
\D 1\n\
\R 4\n\
\U 2\n\
\D 1\n\
\R 4\n\
\D 4\n\
\U 3\n\
\R 3\n\
\U 4\n\
\L 1\n\
\D 3\n\
\U 1\n\
\D 3\n\
\R 2\n\
\U 1\n\
\R 3\n\
\L 4\n\
\R 1\n\
\L 4\n\
\D 3\n\
\R 4\n\
\U 2\n\
\L 1\n\
\D 4\n\
\L 2\n\
\R 4\n\
\L 2\n\
\R 3\n\
\L 3\n\
\U 2\n\
\R 3\n\
\L 2\n\
\R 1\n\
\D 4\n\
\L 3\n\
\D 3\n\
\L 5\n\
\D 1\n\
\R 3\n\
\D 4\n\
\L 4\n\
\R 2\n\
\D 5\n\
\R 2\n\
\L 2\n\
\D 5\n\
\U 2\n\
\D 1\n\
\U 2\n\
\D 3\n\
\L 2\n\
\D 1\n\
\L 3\n\
\U 1\n\
\D 3\n\
\R 2\n\
\U 4\n\
\R 5\n\
\D 5\n\
\U 3\n\
\R 1\n\
\D 5\n\
\U 1\n\
\D 4\n\
\R 1\n\
\U 4\n\
\D 4\n\
\R 4\n\
\U 5\n\
\D 4\n\
\R 1\n\
\L 1\n\
\D 5\n\
\L 1\n\
\D 4\n\
\U 1\n\
\D 2\n\
\U 1\n\
\D 1\n\
\R 1\n\
\D 2\n\
\R 2\n\
\D 1\n\
\L 5\n\
\R 3\n\
\L 4\n\
\D 3\n\
\R 5\n\
\D 4\n\
\U 2\n\
\R 2\n\
\U 2\n\
\D 2\n\
\U 5\n\
\L 4\n\
\D 5\n\
\L 5\n\
\R 3\n\
\D 2\n\
\U 4\n\
\D 2\n\
\L 3\n\
\R 2\n\
\L 1\n\
\U 2\n\
\R 4\n\
\L 5\n\
\R 4\n\
\D 1\n\
\U 5\n\
\D 4\n\
\L 5\n\
\R 2\n\
\U 4\n\
\D 3\n\
\L 3\n\
\D 3\n\
\L 1\n\
\U 5\n\
\L 4\n\
\R 1\n\
\U 5\n\
\D 4\n\
\R 2\n\
\L 1\n\
\D 2\n\
\R 3\n\
\L 2\n\
\R 5\n\
\D 5\n\
\R 2\n\
\L 1\n\
\U 3\n\
\D 2\n\
\L 1\n\
\U 1\n\
\R 4\n\
\U 1\n\
\D 1\n\
\U 1\n\
\R 2\n\
\U 3\n\
\R 4\n\
\L 4\n\
\R 1\n\
\U 3\n\
\R 3\n\
\D 1\n\
\L 3\n\
\R 4\n\
\L 1\n\
\U 5\n\
\D 6\n\
\U 2\n\
\L 4\n\
\D 2\n\
\U 1\n\
\D 4\n\
\R 5\n\
\L 2\n\
\R 6\n\
\L 6\n\
\U 1\n\
\D 4\n\
\L 3\n\
\D 5\n\
\U 4\n\
\L 4\n\
\R 2\n\
\D 2\n\
\L 3\n\
\D 1\n\
\U 6\n\
\L 6\n\
\R 2\n\
\D 2\n\
\U 3\n\
\L 6\n\
\R 1\n\
\U 5\n\
\R 5\n\
\U 5\n\
\D 1\n\
\L 2\n\
\U 1\n\
\R 1\n\
\D 5\n\
\L 6\n\
\R 1\n\
\D 4\n\
\R 3\n\
\L 3\n\
\D 2\n\
\U 5\n\
\D 6\n\
\U 3\n\
\D 6\n\
\U 4\n\
\L 2\n\
\R 1\n\
\U 5\n\
\D 2\n\
\L 1\n\
\D 4\n\
\U 1\n\
\R 2\n\
\L 2\n\
\R 4\n\
\D 1\n\
\L 6\n\
\D 5\n\
\L 6\n\
\R 6\n\
\L 3\n\
\U 5\n\
\R 4\n\
\D 4\n\
\L 3\n\
\D 2\n\
\L 1\n\
\R 4\n\
\U 3\n\
\R 2\n\
\U 2\n\
\R 5\n\
\D 1\n\
\U 5\n\
\D 4\n\
\R 4\n\
\L 5\n\
\D 5\n\
\U 3\n\
\R 1\n\
\U 4\n\
\L 5\n\
\U 1\n\
\D 2\n\
\U 4\n\
\D 4\n\
\L 1\n\
\U 2\n\
\L 3\n\
\U 5\n\
\R 1\n\
\L 5\n\
\U 1\n\
\R 4\n\
\D 2\n\
\L 6\n\
\U 6\n\
\R 6\n\
\U 5\n\
\R 6\n\
\U 6\n\
\L 5\n\
\U 1\n\
\L 5\n\
\D 3\n\
\R 1\n\
\D 4\n\
\L 3\n\
\D 7\n\
\U 1\n\
\D 4\n\
\R 2\n\
\U 4\n\
\D 4\n\
\U 7\n\
\D 3\n\
\L 3\n\
\D 3\n\
\R 4\n\
\D 7\n\
\R 4\n\
\D 5\n\
\U 3\n\
\L 5\n\
\R 5\n\
\D 5\n\
\L 2\n\
\R 3\n\
\L 2\n\
\R 4\n\
\U 2\n\
\L 4\n\
\U 7\n\
\L 2\n\
\U 6\n\
\D 3\n\
\U 6\n\
\R 2\n\
\D 2\n\
\U 6\n\
\L 2\n\
\R 4\n\
\U 5\n\
\D 2\n\
\R 4\n\
\L 2\n\
\D 2\n\
\R 1\n\
\D 3\n\
\R 1\n\
\D 3\n\
\U 4\n\
\D 2\n\
\L 4\n\
\D 1\n\
\L 5\n\
\U 1\n\
\R 2\n\
\D 3\n\
\U 4\n\
\D 4\n\
\L 5\n\
\R 2\n\
\D 2\n\
\U 1\n\
\D 7\n\
\L 7\n\
\R 2\n\
\L 6\n\
\D 4\n\
\R 7\n\
\L 3\n\
\U 2\n\
\D 2\n\
\U 4\n\
\L 5\n\
\D 4\n\
\U 4\n\
\R 5\n\
\L 5\n\
\D 2\n\
\R 5\n\
\L 7\n\
\U 1\n\
\D 7\n\
\L 3\n\
\R 4\n\
\L 5\n\
\D 5\n\
\L 2\n\
\R 5\n\
\L 3\n\
\R 2\n\
\L 4\n\
\R 1\n\
\D 3\n\
\L 5\n\
\R 2\n\
\D 4\n\
\U 3\n\
\R 3\n\
\L 5\n\
\D 3\n\
\R 1\n\
\D 5\n\
\R 5\n\
\L 1\n\
\D 6\n\
\R 5\n\
\D 4\n\
\U 2\n\
\L 4\n\
\U 1\n\
\D 3\n\
\L 2\n\
\D 7\n\
\R 4\n\
\L 1\n\
\U 6\n\
\R 8\n\
\L 2\n\
\U 2\n\
\R 1\n\
\U 7\n\
\D 6\n\
\L 7\n\
\R 3\n\
\U 5\n\
\R 4\n\
\L 8\n\
\D 2\n\
\R 4\n\
\U 8\n\
\L 6\n\
\R 1\n\
\L 7\n\
\D 5\n\
\L 3\n\
\R 6\n\
\U 1\n\
\D 7\n\
\L 2\n\
\U 7\n\
\R 1\n\
\U 6\n\
\L 3\n\
\R 8\n\
\D 5\n\
\L 4\n\
\R 4\n\
\L 6\n\
\D 6\n\
\R 3\n\
\L 2\n\
\U 5\n\
\R 3\n\
\D 1\n\
\R 7\n\
\L 1\n\
\U 8\n\
\D 2\n\
\U 3\n\
\D 1\n\
\L 2\n\
\U 6\n\
\L 1\n\
\U 4\n\
\R 6\n\
\U 7\n\
\R 1\n\
\D 1\n\
\U 8\n\
\R 1\n\
\D 7\n\
\L 1\n\
\U 4\n\
\D 1\n\
\U 2\n\
\R 8\n\
\U 1\n\
\D 6\n\
\R 1\n\
\U 1\n\
\R 5\n\
\L 7\n\
\R 3\n\
\D 3\n\
\U 8\n\
\L 6\n\
\D 7\n\
\U 8\n\
\L 4\n\
\R 1\n\
\L 7\n\
\U 4\n\
\D 3\n\
\L 3\n\
\R 6\n\
\D 3\n\
\U 8\n\
\L 5\n\
\D 8\n\
\L 1\n\
\U 7\n\
\R 6\n\
\L 5\n\
\U 8\n\
\R 2\n\
\L 8\n\
\R 7\n\
\L 8\n\
\U 7\n\
\D 7\n\
\U 3\n\
\D 4\n\
\U 8\n\
\D 5\n\
\U 3\n\
\L 4\n\
\D 4\n\
\U 8\n\
\R 7\n\
\U 7\n\
\L 7\n\
\R 4\n\
\L 1\n\
\D 8\n\
\R 9\n\
\D 4\n\
\R 8\n\
\L 5\n\
\R 9\n\
\U 5\n\
\D 1\n\
\L 5\n\
\D 7\n\
\U 3\n\
\R 5\n\
\U 1\n\
\R 3\n\
\U 2\n\
\D 9\n\
\U 5\n\
\R 3\n\
\U 4\n\
\R 3\n\
\D 4\n\
\U 7\n\
\D 9\n\
\L 7\n\
\D 3\n\
\U 1\n\
\R 3\n\
\U 4\n\
\L 3\n\
\R 8\n\
\L 3\n\
\U 8\n\
\R 6\n\
\L 6\n\
\D 7\n\
\L 7\n\
\D 4\n\
\L 3\n\
\U 5\n\
\L 2\n\
\R 5\n\
\D 3\n\
\U 6\n\
\L 9\n\
\R 9\n\
\D 9\n\
\U 9\n\
\R 4\n\
\D 8\n\
\R 8\n\
\D 5\n\
\L 7\n\
\U 2\n\
\R 4\n\
\L 8\n\
\R 4\n\
\L 2\n\
\R 3\n\
\L 7\n\
\R 1\n\
\U 1\n\
\L 5\n\
\D 5\n\
\R 9\n\
\D 8\n\
\U 7\n\
\L 3\n\
\R 5\n\
\D 1\n\
\U 1\n\
\R 5\n\
\D 6\n\
\U 9\n\
\D 8\n\
\R 4\n\
\D 7\n\
\L 1\n\
\U 5\n\
\D 8\n\
\L 4\n\
\D 4\n\
\L 7\n\
\D 8\n\
\R 5\n\
\U 9\n\
\D 2\n\
\L 1\n\
\R 2\n\
\U 8\n\
\D 4\n\
\L 6\n\
\D 1\n\
\L 5\n\
\D 6\n\
\R 9\n\
\U 1\n\
\L 9\n\
\U 4\n\
\D 6\n\
\R 8\n\
\L 5\n\
\R 1\n\
\L 2\n\
\R 7\n\
\D 8\n\
\L 4\n\
\R 3\n\
\U 2\n\
\L 7\n\
\U 2\n\
\D 1\n\
\R 8\n\
\U 8\n\
\L 1\n\
\R 1\n\
\D 2\n\
\U 3\n\
\L 5\n\
\D 6\n\
\L 3\n\
\U 6\n\
\R 2\n\
\L 5\n\
\U 6\n\
\L 5\n\
\D 3\n\
\L 6\n\
\D 2\n\
\L 4\n\
\U 10\n\
\R 4\n\
\D 7\n\
\U 4\n\
\D 4\n\
\L 5\n\
\U 3\n\
\L 9\n\
\R 7\n\
\D 1\n\
\L 4\n\
\U 4\n\
\D 5\n\
\R 5\n\
\D 4\n\
\U 1\n\
\D 3\n\
\R 1\n\
\L 6\n\
\U 1\n\
\D 1\n\
\L 4\n\
\U 5\n\
\D 10\n\
\R 4\n\
\U 5\n\
\R 1\n\
\U 2\n\
\R 4\n\
\D 6\n\
\L 7\n\
\U 1\n\
\R 2\n\
\D 1\n\
\L 7\n\
\D 4\n\
\U 9\n\
\L 6\n\
\D 8\n\
\R 3\n\
\U 7\n\
\R 8\n\
\U 2\n\
\D 5\n\
\R 3\n\
\U 10\n\
\D 3\n\
\R 3\n\
\U 1\n\
\R 8\n\
\D 10\n\
\R 3\n\
\D 1\n\
\U 10\n\
\L 5\n\
\U 8\n\
\D 6\n\
\L 9\n\
\D 5\n\
\U 1\n\
\R 9\n\
\U 3\n\
\D 3\n\
\R 8\n\
\L 9\n\
\D 8\n\
\U 3\n\
\R 2\n\
\D 3\n\
\L 7\n\
\D 3\n\
\R 10\n\
\L 9\n\
\U 2\n\
\R 8\n\
\U 8\n\
\R 5\n\
\U 3\n\
\L 9\n\
\U 1\n\
\D 7\n\
\L 7\n\
\R 5\n\
\L 8\n\
\U 8\n\
\L 9\n\
\R 10\n\
\U 1\n\
\R 5\n\
\L 5\n\
\D 7\n\
\L 8\n\
\D 5\n\
\U 4\n\
\L 4\n\
\U 6\n\
\D 4\n\
\L 8\n\
\U 8\n\
\L 10\n\
\D 1\n\
\L 2\n\
\D 3\n\
\U 8\n\
\L 7\n\
\R 7\n\
\U 6\n\
\D 4\n\
\U 8\n\
\L 2\n\
\R 6\n\
\L 7\n\
\D 11\n\
\R 4\n\
\D 9\n\
\L 10\n\
\U 3\n\
\L 9\n\
\U 10\n\
\L 11\n\
\U 11\n\
\D 2\n\
\U 4\n\
\D 5\n\
\L 11\n\
\D 4\n\
\L 6\n\
\U 2\n\
\D 8\n\
\R 4\n\
\U 4\n\
\D 5\n\
\U 8\n\
\L 3\n\
\U 2\n\
\R 7\n\
\U 10\n\
\R 5\n\
\L 3\n\
\R 11\n\
\U 2\n\
\D 8\n\
\U 3\n\
\R 10\n\
\U 10\n\
\L 3\n\
\R 7\n\
\L 8\n\
\D 5\n\
\U 9\n\
\D 9\n\
\R 3\n\
\U 4\n\
\L 6\n\
\D 9\n\
\R 10\n\
\L 2\n\
\R 8\n\
\U 11\n\
\L 2\n\
\R 1\n\
\U 11\n\
\R 2\n\
\D 3\n\
\U 9\n\
\R 3\n\
\L 2\n\
\R 1\n\
\L 6\n\
\R 10\n\
\L 2\n\
\U 6\n\
\R 4\n\
\L 9\n\
\U 11\n\
\L 1\n\
\R 11\n\
\U 8\n\
\L 4\n\
\R 11\n\
\L 6\n\
\D 5\n\
\L 11\n\
\U 3\n\
\D 5\n\
\R 5\n\
\U 2\n\
\L 3\n\
\R 4\n\
\L 9\n\
\R 7\n\
\U 11\n\
\R 7\n\
\U 7\n\
\D 10\n\
\R 11\n\
\D 10\n\
\L 3\n\
\D 5\n\
\U 2\n\
\L 1\n\
\U 2\n\
\R 2\n\
\U 8\n\
\R 1\n\
\L 10\n\
\R 10\n\
\U 5\n\
\D 4\n\
\U 4\n\
\R 4\n\
\L 8\n\
\R 6\n\
\U 9\n\
\R 5\n\
\L 3\n\
\U 9\n\
\L 3\n\
\D 4\n\
\R 10\n\
\D 11\n\
\L 12\n\
\R 1\n\
\U 11\n\
\L 10\n\
\R 11\n\
\D 10\n\
\R 10\n\
\L 4\n\
\U 11\n\
\D 2\n\
\R 8\n\
\L 6\n\
\U 7\n\
\D 7\n\
\L 12\n\
\U 1\n\
\L 3\n\
\D 8\n\
\R 6\n\
\L 7\n\
\R 11\n\
\L 2\n\
\R 6\n\
\U 2\n\
\R 2\n\
\L 2\n\
\U 5\n\
\R 12\n\
\U 12\n\
\D 12\n\
\U 1\n\
\D 6\n\
\L 5\n\
\U 3\n\
\D 3\n\
\L 4\n\
\R 10\n\
\L 5\n\
\U 2\n\
\D 8\n\
\R 4\n\
\D 5\n\
\L 7\n\
\U 2\n\
\R 10\n\
\D 12\n\
\R 9\n\
\U 11\n\
\D 10\n\
\R 4\n\
\U 2\n\
\D 1\n\
\U 10\n\
\D 8\n\
\R 2\n\
\L 9\n\
\D 12\n\
\U 12\n\
\D 2\n\
\U 8\n\
\R 5\n\
\L 8\n\
\D 5\n\
\U 9\n\
\D 8\n\
\U 7\n\
\R 3\n\
\L 10\n\
\U 11\n\
\L 5\n\
\U 12\n\
\L 2\n\
\U 9\n\
\D 7\n\
\R 12\n\
\U 9\n\
\R 2\n\
\L 3\n\
\U 10\n\
\D 9\n\
\L 7\n\
\U 5\n\
\R 3\n\
\D 3\n\
\L 11\n\
\D 1\n\
\R 5\n\
\L 1\n\
\U 5\n\
\L 6\n\
\D 8\n\
\L 2\n\
\D 5\n\
\U 8\n\
\D 9\n\
\R 8\n\
\L 7\n\
\D 6\n\
\L 6\n\
\D 1\n\
\U 5\n\
\L 4\n\
\R 6\n\
\U 9\n\
\L 3\n\
\U 3\n\
\D 7\n\
\L 1\n\
\D 4\n\
\L 9\n\
\R 9\n\
\U 6\n\
\D 8\n\
\U 12\n\
\L 5\n\
\D 4\n\
\R 7\n\
\L 2\n\
\D 4\n\
\U 7\n\
\R 7\n\
\U 2\n\
\R 13\n\
\D 5\n\
\L 1\n\
\R 5\n\
\D 6\n\
\U 2\n\
\L 1\n\
\U 5\n\
\D 2\n\
\R 9\n\
\L 8\n\
\U 9\n\
\D 9\n\
\U 12\n\
\R 10\n\
\U 9\n\
\L 13\n\
\R 5\n\
\D 10\n\
\L 9\n\
\U 4\n\
\D 12\n\
\U 12\n\
\R 13\n\
\D 12\n\
\U 7\n\
\R 12\n\
\D 8\n\
\L 8\n\
\U 2\n\
\D 10\n\
\L 2\n\
\D 5\n\
\U 3\n\
\R 11\n\
\D 4\n\
\R 4\n\
\L 1\n\
\R 1\n\
\D 9\n\
\U 6\n\
\R 10\n\
\U 12\n\
\L 10\n\
\R 13\n\
\D 7\n\
\R 12\n\
\L 5\n\
\R 10\n\
\D 4\n\
\R 11\n\
\L 7\n\
\R 7\n\
\U 7\n\
\D 7\n\
\U 11\n\
\L 3\n\
\R 9\n\
\L 12\n\
\D 11\n\
\R 5\n\
\D 5\n\
\R 7\n\
\D 7\n\
\U 3\n\
\L 11\n\
\D 11\n\
\L 10\n\
\U 7\n\
\L 13\n\
\R 6\n\
\L 10\n\
\U 10\n\
\D 10\n\
\L 4\n\
\R 5\n\
\U 5\n\
\D 2\n\
\L 6\n\
\D 8\n\
\U 1\n\
\R 12\n\
\D 11\n\
\U 3\n\
\L 9\n\
\R 10\n\
\U 8\n\
\R 10\n\
\D 2\n\
\R 3\n\
\U 9\n\
\D 7\n\
\L 6\n\
\R 9\n\
\D 2\n\
\U 11\n\
\R 3\n\
\D 1\n\
\R 4\n\
\L 11\n\
\U 13\n\
\R 12\n\
\U 12\n\
\R 8\n\
\L 13\n\
\U 7\n\
\D 10\n\
\R 11\n\
\L 2\n\
\U 9\n\
\L 3\n\
\R 5\n\
\L 4\n\
\R 11\n\
\D 5\n\
\R 1\n\
\L 11\n\
\U 10\n\
\R 4\n\
\L 1\n\
\U 2\n\
\D 8\n\
\L 7\n\
\U 1\n\
\L 4\n\
\D 1\n\
\R 1\n\
\L 11\n\
\U 8\n\
\R 11\n\
\U 4\n\
\R 10\n\
\L 6\n\
\D 7\n\
\U 9\n\
\L 14\n\
\U 1\n\
\R 10\n\
\U 12\n\
\R 1\n\
\L 6\n\
\D 9\n\
\U 10\n\
\L 10\n\
\D 5\n\
\R 14\n\
\U 3\n\
\R 13\n\
\U 3\n\
\L 13\n\
\U 8\n\
\L 10\n\
\U 7\n\
\R 12\n\
\U 11\n\
\R 6\n\
\U 6\n\
\D 6\n\
\R 2\n\
\L 7\n\
\R 8\n\
\U 8\n\
\D 3\n\
\R 8\n\
\L 12\n\
\U 11\n\
\D 9\n\
\U 6\n\
\R 8\n\
\D 8\n\
\U 9\n\
\R 12\n\
\L 11\n\
\U 10\n\
\L 14\n\
\R 9\n\
\D 8\n\
\U 14\n\
\L 9\n\
\D 11\n\
\U 2\n\
\R 2\n\
\U 4\n\
\R 7\n\
\U 11\n\
\L 8\n\
\D 12\n\
\L 11\n\
\U 13\n\
\L 1\n\
\D 8\n\
\U 8\n\
\L 10\n\
\U 12\n\
\R 11\n\
\U 3\n\
\D 12\n\
\L 1\n\
\D 8\n\
\L 4\n\
\D 3\n\
\L 2\n\
\U 8\n\
\D 9\n\
\L 1\n\
\U 9\n\
\D 15\n\
\U 5\n\
\L 9\n\
\D 2\n\
\U 4\n\
\L 2\n\
\U 15\n\
\L 8\n\
\R 2\n\
\U 1\n\
\L 3\n\
\D 10\n\
\L 15\n\
\U 2\n\
\R 14\n\
\D 1\n\
\U 13\n\
\D 4\n\
\R 8\n\
\D 6\n\
\R 5\n\
\D 13\n\
\L 5\n\
\R 6\n\
\U 14\n\
\L 15\n\
\D 15\n\
\U 12\n\
\L 1\n\
\D 3\n\
\L 6\n\
\D 2\n\
\R 4\n\
\D 10\n\
\U 12\n\
\R 13\n\
\L 3\n\
\R 15\n\
\D 13\n\
\U 15\n\
\D 14\n\
\U 8\n\
\D 10\n\
\U 5\n\
\D 11\n\
\R 15\n\
\D 7\n\
\R 1\n\
\D 2\n\
\L 5\n\
\U 11\n\
\L 14\n\
\U 9\n\
\D 13\n\
\R 12\n\
\U 10\n\
\R 11\n\
\D 9\n\
\R 6\n\
\D 7\n\
\L 7\n\
\U 14\n\
\D 12\n\
\L 6\n\
\D 15\n\
\U 11\n\
\R 1\n\
\U 3\n\
\L 11\n\
\R 3\n\
\L 9\n\
\R 9\n\
\L 11\n\
\R 12\n\
\U 6\n\
\R 13\n\
\D 13\n\
\L 9\n\
\U 3\n\
\D 6\n\
\L 4\n\
\D 3\n\
\U 15\n\
\D 13\n\
\U 9\n\
\D 1\n\
\U 13\n\
\D 12\n\
\L 4\n\
\U 6\n\
\R 11\n\
\D 2\n\
\R 7\n\
\U 9\n\
\R 11\n\
\U 3\n\
\L 7\n\
\U 4\n\
\R 2\n\
\D 14\n\
\U 3\n\
\D 14\n\
\R 13\n\
\L 4\n\
\R 1\n\
\U 12\n\
\D 10\n\
\L 8\n\
\D 2\n\
\L 15\n\
\U 1\n\
\D 4\n\
\U 16\n\
\R 15\n\
\D 1\n\
\R 8\n\
\U 14\n\
\L 12\n\
\U 2\n\
\R 1\n\
\D 16\n\
\L 10\n\
\R 11\n\
\D 10\n\
\L 15\n\
\R 7\n\
\U 10\n\
\L 3\n\
\U 11\n\
\D 1\n\
\L 5\n\
\D 3\n\
\U 8\n\
\R 3\n\
\U 5\n\
\R 2\n\
\D 11\n\
\L 2\n\
\D 7\n\
\L 2\n\
\U 3\n\
\L 12\n\
\D 13\n\
\L 12\n\
\U 7\n\
\R 11\n\
\L 4\n\
\R 11\n\
\L 8\n\
\U 16\n\
\L 1\n\
\R 11\n\
\L 4\n\
\U 15\n\
\L 16\n\
\R 15\n\
\U 6\n\
\R 4\n\
\U 3\n\
\D 16\n\
\R 9\n\
\U 8\n\
\R 5\n\
\U 6\n\
\L 2\n\
\R 2\n\
\D 10\n\
\R 7\n\
\D 13\n\
\U 13\n\
\R 14\n\
\D 3\n\
\L 15\n\
\R 3\n\
\D 11\n\
\L 4\n\
\U 12\n\
\D 1\n\
\U 8\n\
\R 8\n\
\L 4\n\
\D 6\n\
\L 15\n\
\U 7\n\
\D 15\n\
\L 11\n\
\U 14\n\
\D 8\n\
\U 15\n\
\L 12\n\
\R 6\n\
\U 13\n\
\R 5\n\
\U 2\n\
\L 1\n\
\R 13\n\
\D 10\n\
\R 7\n\
\L 9\n\
\U 14\n\
\R 1\n\
\D 13\n\
\L 11\n\
\U 9\n\
\L 13\n\
\R 5\n\
\D 14\n\
\R 16\n\
\U 5\n\
\D 9\n\
\R 2\n\
\D 5\n\
\R 8\n\
\L 8\n\
\U 16\n\
\D 12\n\
\R 3\n\
\U 3\n\
\D 5\n\
\U 12\n\
\D 14\n\
\L 9\n\
\U 12\n\
\R 6\n\
\L 9\n\
\U 3\n\
\D 16\n\
\U 15\n\
\R 6\n\
\D 11\n\
\R 10\n\
\D 3\n\
\U 16\n\
\L 11\n\
\R 2\n\
\L 2\n\
\R 9\n\
\D 12\n\
\L 8\n\
\D 8\n\
\R 13\n\
\L 5\n\
\D 17\n\
\L 7\n\
\D 10\n\
\U 13\n\
\L 11\n\
\U 17\n\
\L 13\n\
\R 2\n\
\D 6\n\
\R 14\n\
\D 14\n\
\L 15\n\
\R 8\n\
\D 4\n\
\U 7\n\
\L 6\n\
\R 6\n\
\U 7\n\
\D 12\n\
\R 9\n\
\L 8\n\
\D 15\n\
\L 14\n\
\R 1\n\
\U 8\n\
\L 13\n\
\D 16\n\
\R 2\n\
\U 2\n\
\L 2\n\
\D 13\n\
\U 8\n\
\D 6\n\
\U 10\n\
\L 9\n\
\R 2\n\
\L 7\n\
\U 5\n\
\R 6\n\
\U 12\n\
\D 3\n\
\R 1\n\
\U 4\n\
\R 17\n\
\U 11\n\
\L 3\n\
\U 13\n\
\L 12\n\
\U 6\n\
\R 5\n\
\D 12\n\
\R 4\n\
\U 4\n\
\R 3\n\
\D 11\n\
\U 7\n\
\L 10\n\
\D 12\n\
\U 12\n\
\D 9\n\
\R 4\n\
\L 2\n\
\R 9\n\
\L 13\n\
\D 16\n\
\L 14\n\
\D 5\n\
\L 8\n\
\D 6\n\
\L 13\n\
\U 1\n\
\R 7\n\
\U 5\n\
\R 2\n\
\U 11\n\
\L 10\n\
\D 14\n\
\R 11\n\
\L 5\n\
\D 16\n\
\U 9\n\
\D 3\n\
\U 11\n\
\D 1\n\
\U 5\n\
\D 3\n\
\U 8\n\
\L 1\n\
\D 1\n\
\U 5\n\
\L 17\n\
\D 9\n\
\L 14\n\
\R 8\n\
\D 15\n\
\R 10\n\
\U 4\n\
\R 1\n\
\U 3\n\
\R 5\n\
\L 13\n\
\D 6\n\
\L 15\n\
\U 10\n\
\L 5\n\
\R 14\n\
\L 1\n\
\R 6\n\
\D 10\n\
\L 13\n\
\D 3\n\
\L 1\n\
\U 10\n\
\D 6\n\
\R 16\n\
\D 6\n\
\R 4\n\
\D 9\n\
\U 9\n\
\D 4\n\
\R 1\n\
\D 10\n\
\R 7\n\
\D 14\n\
\R 10\n\
\D 14\n\
\U 14\n\
\D 15\n\
\R 11\n\
\L 16\n\
\D 18\n\
\R 6\n\
\U 8\n\
\D 18\n\
\R 18\n\
\D 14\n\
\U 9\n\
\R 18\n\
\U 14\n\
\L 18\n\
\U 1\n\
\R 14\n\
\D 1\n\
\U 6\n\
\R 3\n\
\L 13\n\
\D 4\n\
\L 9\n\
\D 2\n\
\U 5\n\
\D 6\n\
\U 9\n\
\L 13\n\
\U 12\n\
\R 11\n\
\D 17\n\
\U 17\n\
\L 8\n\
\U 15\n\
\R 16\n\
\L 9\n\
\D 2\n\
\R 16\n\
\D 2\n\
\L 9\n\
\D 9\n\
\R 15\n\
\D 10\n\
\L 12\n\
\R 14\n\
\L 4\n\
\R 17\n\
\D 15\n\
\U 16\n\
\R 7\n\
\D 4\n\
\U 4\n\
\L 7\n\
\D 16\n\
\R 11\n\
\D 2\n\
\U 2\n\
\L 7\n\
\U 15\n\
\L 5\n\
\U 14\n\
\L 7\n\
\U 15\n\
\D 9\n\
\L 14\n\
\D 13\n\
\U 11\n\
\R 10\n\
\U 15\n\
\L 5\n\
\U 16\n\
\D 13\n\
\U 15\n\
\L 18\n\
\R 1\n\
\D 17\n\
\U 18\n\
\R 19\n\
\L 4\n\
\R 15\n\
\U 12\n\
\D 19\n\
\R 5\n\
\D 18\n\
\L 14\n\
\U 5\n\
\L 4\n\
\R 6\n\
\U 15\n\
\L 7\n\
\R 11\n\
\L 15\n\
\U 12\n\
\D 3\n\
\R 14\n\
\U 1\n\
\L 4\n\
\R 3\n\
\U 15\n\
\L 15\n\
\R 6\n\
\L 3\n\
\U 2\n\
\D 6\n\
\L 6\n\
\D 16\n\
\L 19\n\
\U 9\n\
\L 2\n\
\R 13\n\
\U 8\n\
\R 17\n\
\D 17\n\
\L 4\n\
\R 2\n\
\L 7\n\
\R 11\n\
\D 5\n\
\L 14\n\
\D 7\n\
\R 13\n\
\D 2\n\
\L 18\n\
\U 11\n\
\R 2\n\
\D 18\n\
\U 2\n\
\D 6\n\
\L 4\n\
\U 2\n\
\L 15\n\
\R 4\n\
\D 8\n\
\R 1\n\
\U 16\n\
\L 4\n\
\R 5\n\
\U 16\n\
\D 14\n\
\U 2\n\
\D 19\n\
\L 6\n\
\D 14\n\
\U 17\n\
\L 3\n\
\R 11\n\
\L 2\n\
\R 11\n\
\U 11\n\
\D 4\n\
\U 13\n\
\L 6\n\
\U 14\n\
\D 17\n\
\U 15\n\
\D 7\n\
\R 8\n\
\U 3\n\
\R 15\n\
\D 17\n\
\U 16\n\
\R 3\n\
\D 17\n\
\L 9\n\
\U 15\n\
\R 15\n\
\L 11\n\
\R 18\n\
\D 16\n\
\R 17\n\
\D 3\n\
\L 17\n\
\D 4\n\
\L 10\n\
\U 2\n\
\R 2\n\
\D 9\n\
\L 17\n\
\R 19"